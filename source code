#include <iostream>
#include <string>
#include <vector>
#include <iomanip>
using namespace std;
void desimt_dve_sveik(int x) {  //dešimtainė į dvejetainę (sveikoji dalis)
	vector <int> dve;
	int y;
	while (x > 0) {         //dalina kol dalinasi, o liekana į vektorių
		y = x % 2;
		x /= 2;
		dve.push_back(y);}
	for (int i = dve.size() - 1; i >= 0; i--) {     //nuo vektoriaus galo atspausdina
		cout << dve[i];
	}
	cout << ",";
	dve.clear();
	}
void desimt_dve_trup(long double y) {     // iš dešimtainės į dvejetainę (trupmeninė dalis)   
	vector <int> dve;
	int x=0;
	for (int i = 50; i >= 0; i--) {         //daugina(51skaičiai po kablelio), sveiką skaičių talpina į vektorių
		y *= 2;
		x = y;
		y -= x;
		dve.push_back(x);
	}
	for (int i =0; i <dve.size(); i++) { //atspausdina nuo pradžių
		cout << dve[i];
	}
	dve.clear();
}
void desimt_ast_sveik(int x) { //iš dešimtainės į aštuntainę, sveiką dalį naudojant <iomanip> biblioteką
	cout << oct << x << ",";
}
void desimt_ast_trup(long double y) { //iš dešimtainės į aštuntainę (trupmeninė dalis)
	vector <int> ast;
	int x=0;
	for (int i = 50; i >= 0; i--) { //51 skaičiai po kablelio, daugina, ir sveiką dalį į vektorių deda
		y *= 8;
		x = y;
		y -= x;
		ast.push_back(x);
	}
	for (int i = 0; i <ast.size(); i++) {
		cout << ast[i];
	}
}
void desimt_ses_sveik(int x) { //dešimtainis į šešioliktainę(sveikoji dalis). iomanip
	cout << hex << x << ",";
}
void desimt_ses_trup(long double y) { //desimtainis į šešioliktainę(trupmeninė dalis)
	vector <string> ses;
	int x = 0;
	string z = " ";
	for (int i = 50; i >= 0; i--) {
		y *= 16;
		x = y;
		y -= x;
		if (x > 9) {         //skaičiai didesni nei 9, verčiami į raides
			switch (x) {
			case 10:
				z = "a";
				break;
			case 11:
				z = "b";
				break;
			case 12:
				z = "c";
				break;
			case 13:
				z = "d";
				break;
			case 14:
				z = "e";
				break;
			case 15:
				z = "f";
				break;
			}
		}
		else { z = to_string(x); }     //int verčiami į string, kad dėti į tą patį vektorių
		ses.push_back(z);
	}
	for (int i = 0; i <ses.size(); i++) {
		cout << ses[i];
	}
	ses.clear();
}
double astunt_desimt_trup(vector<int> x) {
	long double y = 0;
		for (int i = x.size() - 1 ; i >= 0; --i) { //kodėl ne x.size()-2?????
			y += x[i];
			y /= 8;
		}
	return y;
}
int dve_desimt_sveik(vector<int> x) {     //iš dvejetainės į dešimtainė(sveikoji dalis)
	int y = 0;
	for (int i = 0 ; i < x.size(); ++i) { //prideda kiekvieną vektoriaus skaičių prie daugybos
		y *= 2;
		y += x[i];
	}
	return y;
}
double dve_desimt_trup(vector<int> x) {    //dvejetainė į dešimtainę(trupmeninė dalis)
	long double y = 0;
	for (int i = x.size() - 1; i >= 0; --i) { //dalinam ir pridedam vektoriaus skaičius
		y += x[i];
		y /= 2;
	}
	return y;
}
double ses_desimt_trup(vector<char> x) {  //šešioliktainė į dešimtainę
	int y = 0;
	vector <int> pakaitinis;
	double z = 0;
	for (int i = 0; i < x.size(); ++i) {
		switch (x[i]) {     //char'ai į int
		case 'f':
			y = 15;
			break;
		case 'e':
			y = 14;
			break;
		case 'd':
			y = 13;
			break;
		case 'c':
			y = 12;
			break;
		case 'b':
			y = 11;
			break;
		case 'a':
			y = 10;
			break;
		default: 
			y = x[i]-'0';
		}
		pakaitinis.push_back(y);    //talpinam į naują int vektorių
	}
	for (int i = pakaitinis.size() - 1; i >= 0; --i) {  
		z += pakaitinis[i];
		z /= 16;
	}
	return z;
}
int main() {
	setlocale(LC_ALL, "Lithuanian");
	int pasirinkimas1 = 0;
	int pasirinkimas2 = 0;
	bool pasirin_cikl = true;
	double desimtain = 0;
	bool ivest_cikl = true;
	vector <int> dve_sveik;
	vector <int> dve_trup;
	vector <int> astunt_trup;
	vector <char> ses_trup;
	int x = 0;
	int z = 0;
	long double y = 0;
	char sk = '.';
	char exit = 't';
	
		cout << "KONVERTUOTI Į: \n";
		cout << "-DVEJETAINĮ [2] \n" << "-AŠTUNTAINĮ [8]\n" << "-DEŠIMTAINĮ [10]\n" << "-ŠEŠIOLIKTAINĮ [16]\n" << endl;
		while (pasirin_cikl == true) {            //pasirenka į ką konvertuoti
			cin >> pasirinkimas1;                            
			if (pasirinkimas1 == 2 || pasirinkimas1 == 8 || pasirinkimas1 == 10 || pasirinkimas1 == 16) {
				pasirin_cikl = false;                //patikrina ivedimą
			}
			else { cout << "Blogai įvestas pasirinkimas....mėginkite dar kartą\n"; }
		}

		cout << "\nNORIMAS KONVERTUOTI SKAIČIUS: \n";
		cout << "-DVEJETAINIS [2]\n" << "-AŠTUNTAINIS [8]\n" << "-DEŠIMTAINIS [10]\n" << "-ŠEŠIOLIKTAINIS [16]\n" << endl;
		while (pasirin_cikl == false) {
			cin >> pasirinkimas2;              // pasirenką ką konvertuos
			if (pasirinkimas2 == pasirinkimas1) {           //tirkina įvedimą
				pasirin_cikl = false;
				cout << "Jūsų pasirinkimai sutampta! pasirinkite iš naujo\n";
			}
			else if (pasirinkimas2 == 2 || pasirinkimas2 == 8 || pasirinkimas2 == 10 || pasirinkimas2 == 16) {
				pasirin_cikl = true;
			}
			else { cout << "Blogai įvestas pasirinkimas....mėginkite dar kartą\n"; }
		}

//dvejetainio skaičiaus įvedimas ir skaičiavimai
		if (pasirinkimas2 == 2) {
			cout << "Veskite skaičius atskirdami juos tarpais, norėdami baigti įveskite bet kokį ne dvejetainį skaičių\n";
			cout << "Įveskite skaičiaus sveikąją dalį: \n";   //sveika dalis
			cin >> x;
			while (x == 1 || x == 0) {                            //talpina į vektorių, nutraukia bet koks ne dvejetainis skaičius
				dve_sveik.push_back(x);
				cin >> x;
			}
			cout << "Įveskite skaičiaus trupmeninę dalį: \n";     //trupmeninė dalis
			cin >> x;
			while (x == 1 || x == 0) {                            //talpina į vektorių, nutraukia bet koks ne dvejetainis skaičius
				dve_trup.push_back(x);
				cin >> x;
			}
			x = dve_desimt_sveik(dve_sveik);                        //sveika dalis paversta į dešimtainę
			y = dve_desimt_trup(dve_trup);                          //trupmeninė dalis paversta į dešimtainę

			if (pasirinkimas1 == 8) {
				desimt_ast_sveik(x);
				desimt_ast_trup(y);
			}
			else if (pasirinkimas1 == 10) {
				cout << setprecision(50) << x + y;
			}
			else if (pasirinkimas1 == 16) {
				desimt_ses_sveik(x);
				desimt_ses_trup(y);
			}
			dve_sveik.clear();
			dve_trup.clear();
		}

//aštuntainio skaičiaus įvedimas ir skaičiavimai
		else if (pasirinkimas2 == 8) {
			cout << "Įveskite skaičiaus sveikąją dalį: \n";   //sveika dalis
			cin >> oct >> x >> dec;                                  //paverčia iškart į dešimtainę
			cin.clear();
			cout << "Įveskite skaičiaus trupmeninę dalį: \n";
			cout << "Veskite skaičius atskirdami juos tarpais, norėdami baigti įveskite bet kokį ne aštuntainį skaičių" << endl;
			while ((cin>>z) && (z >= 0 && z <= 7)) {
				astunt_trup.push_back(z);
			}
			y = astunt_desimt_trup(astunt_trup);             //paversta į dešimtainę(trupmeninė dalis)
		    if (pasirinkimas1 == 2) {                        //iš aštuntainės į dvejetainę
				desimt_dve_sveik(x);
				desimt_dve_trup(y);
			}
			else if (pasirinkimas1 == 10) {                  // i6 aštuntainės į dešimtainę
				cout << setprecision(50) << x + y;
			}
			else if (pasirinkimas1 == 16) {                  // iš aštuntainės į šešioliktainę
				desimt_ses_sveik(x);
				desimt_ses_trup(y);
			}
			astunt_trup.clear(); //išvalom vektorių
			cin.clear();
		}

//dešimtainio skaičiaus inputas
		else if (pasirinkimas2 == 10) {
			cout << "Įveskite skaičių: \n";
			cin >> y;
			x = y;          //x sveika dalis 
			y -= x;           //y trupmeninė dalis
			if (pasirinkimas1 == 2) {
				desimt_dve_sveik(x);
				desimt_dve_trup(y);
			}
			else if (pasirinkimas1 == 8) {
				desimt_ast_sveik(x);
				desimt_ast_trup(y);
			}
			else if (pasirinkimas1 == 16) {
				desimt_ses_sveik(x);
				desimt_ses_trup(y);
			}
		}

//šešioliktainio skaičiaus įvedimas ir skaičiavimai
		else if (pasirinkimas2 == 16) {
			cout << "Įveskite skaičiaus sveikąją dalį: \n";   //sveika dalis
			cin >> hex >> x >> dec;                                  //paverčia iškart į dešimtainę
			cin.clear();
			cout << "Įveskite skaičiaus trupmeninę dalį: \n";
			cout << "Veskite reikšmes atskirdami jas tarpais, norėdami baigti įveskite [X]\n";
			while ((cin >> sk) && sk != 'x') {
				ses_trup.push_back(sk);
			}
			y = ses_desimt_trup(ses_trup);        //paversta į dešimtainę trupmeninė dalis
			if (pasirinkimas1 == 2) {
				desimt_dve_sveik(x);
				desimt_dve_trup(y);
			}
			else if (pasirinkimas1 == 8) {
				desimt_ast_sveik(x);
				desimt_ast_trup(y);
			}
			else if (pasirinkimas1 == 10) {
				cout << setprecision(50) << x + y;
			}
			ses_trup.clear(); //išvalom vektorių
		}

		cout << "\nAr norite išeiti?\n Taip[t]\t\tNe[n]\n";
		cin.ignore();
		cin >> exit;                         //arba uždaro ciklą arba iš naujo
		if (exit == 'n') {
			main();
		}
	return 0;
}
